<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Combine Independent P-Values (Fisher's Method) — fisher_combine • hypothesize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Combine Independent P-Values (Fisher's Method) — fisher_combine"><meta property="og:description" content="Combines p-values from independent hypothesis tests into a single
omnibus test using Fisher's method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hypothesize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to hypothesize</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/queelius/hypothesize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Combine Independent P-Values (Fisher's Method)</h1>
    <small class="dont-index">Source: <a href="https://github.com/queelius/hypothesize/blob/HEAD/R/hypothesize.R" class="external-link"><code>R/hypothesize.R</code></a></small>
    <div class="hidden name"><code>fisher_combine.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Combines p-values from independent hypothesis tests into a single
omnibus test using Fisher's method.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fisher_combine</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><code>hypothesis_test</code> objects to combine, or numeric p-values.
All tests must be independent.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>hypothesis_test</code> object of subclass <code>fisher_combined_test</code>
containing:</p><dl><dt>stat</dt>
<dd><p>Fisher's chi-squared statistic \(-2\sum\log(p_i)\)</p></dd>

<dt>p.value</dt>
<dd><p>P-value from \(\chi^2_{2k}\) distribution</p></dd>

<dt>dof</dt>
<dd><p>Degrees of freedom (\(2k\))</p></dd>

<dt>n_tests</dt>
<dd><p>Number of tests combined</p></dd>

<dt>component_pvals</dt>
<dd><p>Vector of the individual p-values</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Fisher's method is a meta-analytic technique for combining evidence from
multiple independent tests of the same hypothesis (or related hypotheses).
It demonstrates a key principle: <strong>combining hypothesis tests yields a
hypothesis test</strong> (the closure property).</p>
<p>Given \(k\) independent p-values \(p_1, \ldots, p_k\), Fisher's
statistic is:</p>
<p>$$X^2 = -2 \sum_{i=1}^{k} \log(p_i)$$</p>
<p>Under the global null hypothesis (all individual nulls are true), this
follows a chi-squared distribution with \(2k\) degrees of freedom.</p>
    </div>
    <div id="why-it-works">
    <h2>Why It Works</h2>


<p>If \(p_i\) is a valid p-value under \(H_0\), then \(p_i \sim U(0,1)\).
Therefore \(-2\log(p_i) \sim \chi^2_2\). The sum of independent
chi-squared random variables is also chi-squared with summed degrees of
freedom, giving \(X^2 \sim \chi^2_{2k}\).</p>
    </div>
    <div id="interpretation">
    <h2>Interpretation</h2>


<p>A significant combined p-value indicates that <strong>at least one</strong> of the
individual null hypotheses is likely false, but does not identify which
one(s). Fisher's method is sensitive to any deviation from the global
null, making it powerful when effects exist but liberal when assumptions
are violated.</p>
    </div>
    <div id="closure-property-sicp-principle-">
    <h2>Closure Property (SICP Principle)</h2>


<p>This function exemplifies the closure property from SICP: the operation
of combining hypothesis tests produces another hypothesis test. The result
can be further combined, adjusted, or analyzed using the same generic
methods (<code><a href="pval.html">pval()</a></code>, <code><a href="test_stat.html">test_stat()</a></code>, <code><a href="is_significant_at.html">is_significant_at()</a></code>, etc.).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="adjust_pval.html">adjust_pval()</a></code> for multiple testing correction (different goal)</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Scenario: Three independent studies test the same drug effect</span></span></span>
<span class="r-in"><span><span class="co"># Study 1: p = 0.08 (trend, not significant)</span></span></span>
<span class="r-in"><span><span class="co"># Study 2: p = 0.12 (not significant)</span></span></span>
<span class="r-in"><span><span class="co"># Study 3: p = 0.04 (significant at 0.05)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine using raw p-values</span></span></span>
<span class="r-in"><span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu">fisher_combine</span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.12</span>, <span class="fl">0.04</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">combined</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis test ( fisher_combined_test )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistic:  15.72974 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value:  0.01528049 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom:  6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significant at 5% level:  TRUE </span>
<span class="r-in"><span><span class="fu"><a href="is_significant_at.html">is_significant_at</a></span><span class="op">(</span><span class="va">combined</span>, <span class="fl">0.05</span><span class="op">)</span>  <span class="co"># Stronger evidence together</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or combine hypothesis_test objects directly</span></span></span>
<span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="wald_test.html">wald_test</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fl">1.5</span>, se <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="wald_test.html">wald_test</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fl">0.8</span>, se <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="z_test.html">z_test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, mu0 <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fisher_combine</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span>, <span class="va">t3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis test ( fisher_combined_test )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistic:  20.14234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value:  0.002612353 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom:  6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significant at 5% level:  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The result is itself a hypothesis_test, so it composes</span></span></span>
<span class="r-in"><span><span class="co"># (though combining non-independent tests is invalid)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

